<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Prig: Open Source Alternative to Microsoft Fakes By: @urasandesu</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Prig</h1>
        <p class="header">Open Source Alternative to Microsoft Fakes</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/urasandesu/Prig/releases/download/v1.0.0/Prig-v1.0.0.with.binary.zip">Download BIN</a></li>
          <li class="download"><a class="buttons" href="https://github.com/urasandesu/Prig/releases/download/v1.0.0/Prig-v1.0.0.zip">Download SRC</a></li>
          <li><a class="buttons github" href="https://github.com/urasandesu/Prig">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/urasandesu">urasandesu</a></p>


      </header>
      <section>
        <h1>
<a id="prig" class="anchor" href="#prig" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prig</h1>

<h2>
<a id="synopsis" class="anchor" href="#synopsis" aria-hidden="true"><span class="octicon octicon-link"></span></a>SYNOPSIS</h2>

<p>Prig is a lightweight framework for test indirections in .NET Framework.</p>

<h2>
<a id="description" class="anchor" href="#description" aria-hidden="true"><span class="octicon octicon-link"></span></a>DESCRIPTION</h2>

<p>Prig(PRototyping jIG) is a framework that generates a <a href="http://martinfowler.com/bliki/TestDouble.html">Test Double</a> like <a href="http://msdn.microsoft.com/en-us/library/hh549175.aspx">Microsoft Fakes</a>/<a href="http://www.typemock.com/isolator-product-page">Typemock Isolator</a>/<a href="http://www.telerik.com/products/mocking.aspx">Telerik JustMock</a> based on Unmanaged Profiler APIs.
This framework enables that any methods are replaced with mocks. For example, a static property, a private method, a non-virtual member and so on.</p>

<h2>
<a id="status" class="anchor" href="#status" aria-hidden="true"><span class="octicon octicon-link"></span></a>STATUS</h2>

<p>As of Nov 16, 2014, Released V1.0.0.</p>

<h2>
<a id="quick-tour" class="anchor" href="#quick-tour" aria-hidden="true"><span class="octicon octicon-link"></span></a>QUICK TOUR</h2>

<p>Let's say you want to test the following code: </p>

<div class="highlight highlight-cs"><pre><span class="pl-k">using</span> System;

<span class="pl-k">namespace</span> ConsoleApplication
{
    <span class="pl-s">public</span> <span class="pl-s">static</span> <span class="pl-s">class</span> <span class="pl-entc">LifeInfo</span>
    {
        <span class="pl-s">public</span> <span class="pl-s">static</span> <span class="pl-s">bool</span> <span class="pl-enf">IsNowLunchBreak</span>()
        {
            <span class="pl-k">var</span> now = DateTime.Now;
            <span class="pl-k">return</span> <span class="pl-cn">12</span> &lt;= now.Hour &amp;&amp; now.Hour &lt; <span class="pl-cn">13</span>;
        }
    }
}</pre></div>

<p>You probably can't test this code, because <code>DateTime.Now</code> returns the value that depends on an external environment. To make be testable, you should replace <code>DateTime.Now</code> to the Test Double that returns the fake information. If you use Prig, it will enable you to generate a Test Double by the following steps without any editing the product code:</p>

<h3>
<a id="step-1-install-from-nuget" class="anchor" href="#step-1-install-from-nuget" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 1: Install From NuGet</h3>

<p>Run Visual Studio 2013(Express for Windows Desktop or more) as Administrator, add test project(e.g. <code>ConsoleApplicationTest</code>) and run the following command in the Package Manager Console: </p>

<div class="highlight highlight-powershell"><pre>PM&gt; <span class="pl-k"><span class="pl-k">Install-Package</span></span> Prig</pre></div>

<p><strong>NOTE:</strong> Installation will mostly go well. However, it doesn't go well if performing just after installing Visual Studio. <a href="https://github.com/urasandesu/Prig/issues/21#issuecomment-58741311">See also this issue's comment</a>.</p>

<h3>
<a id="step-2-add-stub-settings" class="anchor" href="#step-2-add-stub-settings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 2: Add Stub Settings</h3>

<p>Run the following command in the Package Manager Console: </p>

<div class="highlight highlight-powershell"><pre>PM&gt; <span class="pl-k"><span class="pl-k">Add-PrigAssembly</span></span> <span class="pl-ko">-</span>Assembly <span class="pl-s1"><span class="pl-pds">"</span>mscorlib, Version=4.0.0.0<span class="pl-pds">"</span></span></pre></div>

<p>The command means to create the indirection stub settings for the test. The reason to specify <code>mscorlib</code> is that <code>DateTime.Now</code> belongs <code>mscorlib</code>. After the command is invoked, you will get the confirmation message that the project has been modified externally, so reload the project.</p>

<h3>
<a id="step-3-modify-stub-settings" class="anchor" href="#step-3-modify-stub-settings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 3: Modify Stub Settings</h3>

<p>You can find the setting file <code>&lt;assembly name&gt;.&lt;runtime version&gt;.v&lt;assembly version&gt;.prig</code> in the project(in this case, it is <code>mscorlib.v4.0.30319.v4.0.0.0.prig</code>). Modify the setting in accordance with the comment, then build all projects: </p>

<div class="highlight highlight-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-eoa"> version</span>=<span class="pl-s1"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-eoa"> encoding</span>=<span class="pl-s1"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span>?&gt;
&lt;<span class="pl-ent">configuration</span>&gt;

  &lt;<span class="pl-ent">configSections</span>&gt;
    &lt;<span class="pl-ent">section</span> <span class="pl-eoa">name</span>=<span class="pl-s1"><span class="pl-pds">"</span>prig<span class="pl-pds">"</span></span> <span class="pl-eoa">type</span>=<span class="pl-s1"><span class="pl-pds">"</span>Urasandesu.Prig.Framework.PilotStubberConfiguration.PrigSection, Urasandesu.Prig.Framework<span class="pl-pds">"</span></span> /&gt;
  &lt;/<span class="pl-ent">configSections</span>&gt;

  <span class="pl-c"><span class="pl-pdc">&lt;!--</span> </span>
<span class="pl-c">      The content of tag 'add' is generated by the command 'Get-IndirectionStubSetting'.</span>
<span class="pl-c">      Specifically, you can generate it by the following PowerShell script in the Package Manager Console: </span>
<span class="pl-c"></span>
<span class="pl-c">      ========================== EXAMPLE 1 ==========================</span>
<span class="pl-c">      PM&gt; $methods = Find-IndirectionTarget datetime get_Now</span>
<span class="pl-c">      PM&gt; $methods</span>
<span class="pl-c"></span>
<span class="pl-c">      Method</span>
<span class="pl-c">      ======</span>
<span class="pl-c">      System.DateTime get_Now()</span>
<span class="pl-c"></span>
<span class="pl-c"></span>
<span class="pl-c">      PM&gt; $methods[0] | Get-IndirectionStubSetting | clip</span>
<span class="pl-c">      PM&gt;</span>
<span class="pl-c"></span>
<span class="pl-c">      Then, paste the clipboard content to between the tags 'stubs'.</span>
<span class="pl-c">  <span class="pl-pdc">--&gt;</span></span>
  &lt;<span class="pl-ent">prig</span>&gt;

    &lt;<span class="pl-ent">stubs</span>&gt;
      &lt;<span class="pl-ent">add</span> <span class="pl-eoa">name</span>=<span class="pl-s1"><span class="pl-pds">"</span>NowGet<span class="pl-pds">"</span></span> <span class="pl-eoa">alias</span>=<span class="pl-s1"><span class="pl-pds">"</span>NowGet<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">RuntimeMethodInfo</span> <span class="pl-eoa">xmlns</span><span class="pl-eoa">:</span><span class="pl-eoa">i</span>=<span class="pl-s1"><span class="pl-pds">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span><span class="pl-eoa">:</span><span class="pl-eoa">x</span>=<span class="pl-s1"><span class="pl-pds">"</span>http://www.w3.org/2001/XMLSchema<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Id</span>=<span class="pl-s1"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">FactoryType</span>=<span class="pl-s1"><span class="pl-pds">"</span>MemberInfoSerializationHolder<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Type</span>=<span class="pl-s1"><span class="pl-pds">"</span>System.Reflection.MemberInfoSerializationHolder<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Assembly</span>=<span class="pl-s1"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span><span class="pl-eoa">:</span><span class="pl-eoa">z</span>=<span class="pl-s1"><span class="pl-pds">"</span>http://schemas.microsoft.com/2003/10/Serialization/<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span>=<span class="pl-s1"><span class="pl-pds">"</span>http://schemas.datacontract.org/2004/07/System.Reflection<span class="pl-pds">"</span></span>&gt;
          &lt;<span class="pl-ent">Name</span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Id</span>=<span class="pl-s1"><span class="pl-pds">"</span>2<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Type</span>=<span class="pl-s1"><span class="pl-pds">"</span>System.String<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Assembly</span>=<span class="pl-s1"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span>=<span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>&gt;get_Now&lt;/<span class="pl-ent">Name</span>&gt;
          &lt;<span class="pl-ent">AssemblyName</span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Id</span>=<span class="pl-s1"><span class="pl-pds">"</span>3<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Type</span>=<span class="pl-s1"><span class="pl-pds">"</span>System.String<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Assembly</span>=<span class="pl-s1"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span>=<span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>&gt;mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/<span class="pl-ent">AssemblyName</span>&gt;
          &lt;<span class="pl-ent">ClassName</span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Id</span>=<span class="pl-s1"><span class="pl-pds">"</span>4<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Type</span>=<span class="pl-s1"><span class="pl-pds">"</span>System.String<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Assembly</span>=<span class="pl-s1"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span>=<span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>&gt;System.DateTime&lt;/<span class="pl-ent">ClassName</span>&gt;
          &lt;<span class="pl-ent">Signature</span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Id</span>=<span class="pl-s1"><span class="pl-pds">"</span>5<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Type</span>=<span class="pl-s1"><span class="pl-pds">"</span>System.String<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Assembly</span>=<span class="pl-s1"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span>=<span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>&gt;System.DateTime get_Now()&lt;/<span class="pl-ent">Signature</span>&gt;
          &lt;<span class="pl-ent">Signature2</span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Id</span>=<span class="pl-s1"><span class="pl-pds">"</span>6<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Type</span>=<span class="pl-s1"><span class="pl-pds">"</span>System.String<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Assembly</span>=<span class="pl-s1"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span>=<span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>&gt;System.DateTime get_Now()&lt;/<span class="pl-ent">Signature2</span>&gt;
          &lt;<span class="pl-ent">MemberType</span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Id</span>=<span class="pl-s1"><span class="pl-pds">"</span>7<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Type</span>=<span class="pl-s1"><span class="pl-pds">"</span>System.Int32<span class="pl-pds">"</span></span> <span class="pl-eoa">z</span><span class="pl-eoa">:</span><span class="pl-eoa">Assembly</span>=<span class="pl-s1"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span>=<span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>&gt;8&lt;/<span class="pl-ent">MemberType</span>&gt;
          &lt;<span class="pl-ent">GenericArguments</span> <span class="pl-eoa">i</span><span class="pl-eoa">:</span><span class="pl-eoa">nil</span>=<span class="pl-s1"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span> <span class="pl-eoa">xmlns</span>=<span class="pl-s1"><span class="pl-pds">"</span><span class="pl-pds">"</span></span> /&gt;
        &lt;/<span class="pl-ent">RuntimeMethodInfo</span>&gt;
      &lt;/<span class="pl-ent">add</span>&gt;
    &lt;/<span class="pl-ent">stubs</span>&gt;

  &lt;/<span class="pl-ent">prig</span>&gt;

&lt;/<span class="pl-ent">configuration</span>&gt;</pre></div>

<h3>
<a id="step-4-make-tests" class="anchor" href="#step-4-make-tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 4: Make Tests</h3>

<p>In the test code, it becomes testable through the use of the stub and the replacement to Test Double that returns the fake information: </p>

<div class="highlight highlight-cs"><pre><span class="pl-k">using</span> NUnit.Framework;
<span class="pl-k">using</span> ConsoleApplication;
<span class="pl-k">using</span> System;
<span class="pl-k">using</span> System.Prig;
<span class="pl-k">using</span> Urasandesu.Prig.Framework;

<span class="pl-k">namespace</span> ConsoleApplicationTest
{
    [TestFixture]
    <span class="pl-s">public</span> <span class="pl-s">class</span> <span class="pl-entc">LifeInfoTest</span>
    {
        [Test]
        <span class="pl-s">public</span> <span class="pl-s">void</span> <span class="pl-enf">IsNowLunchBreak_should_return_false_when_11_oclock</span>()
        {
            <span class="pl-ko">using</span> (<span class="pl-s">new</span> IndirectionsContext())
            {
                <span class="pl-c">// Arrange</span>
                PDateTime.NowGet().Body = () =&gt; <span class="pl-s">new</span> DateTime(<span class="pl-cn">2013</span>, <span class="pl-cn">12</span>, <span class="pl-cn">13</span>, <span class="pl-cn">11</span>, <span class="pl-cn">00</span>, <span class="pl-cn">00</span>);

                <span class="pl-c">// Act</span>
                <span class="pl-k">var</span> result = LifeInfo.IsNowLunchBreak();

                <span class="pl-c">// Assert</span>
                Assert.IsFalse(result);
            }
        }

        [Test]
        <span class="pl-s">public</span> <span class="pl-s">void</span> <span class="pl-enf">IsNowLunchBreak_should_return_true_when_12_oclock</span>()
        {
            <span class="pl-ko">using</span> (<span class="pl-s">new</span> IndirectionsContext())
            {
                <span class="pl-c">// Arrange</span>
                PDateTime.NowGet().Body = () =&gt; <span class="pl-s">new</span> DateTime(<span class="pl-cn">2013</span>, <span class="pl-cn">12</span>, <span class="pl-cn">13</span>, <span class="pl-cn">12</span>, <span class="pl-cn">00</span>, <span class="pl-cn">00</span>);

                <span class="pl-c">// Act</span>
                <span class="pl-k">var</span> result = LifeInfo.IsNowLunchBreak();

                <span class="pl-c">// Assert</span>
                Assert.IsTrue(result);
            }
        }

        [Test]
        <span class="pl-s">public</span> <span class="pl-s">void</span> <span class="pl-enf">IsNowLunchBreak_should_return_false_when_13_oclock</span>()
        {
            <span class="pl-ko">using</span> (<span class="pl-s">new</span> IndirectionsContext())
            {
                <span class="pl-c">// Arrange</span>
                PDateTime.NowGet().Body = () =&gt; <span class="pl-s">new</span> DateTime(<span class="pl-cn">2013</span>, <span class="pl-cn">12</span>, <span class="pl-cn">13</span>, <span class="pl-cn">13</span>, <span class="pl-cn">00</span>, <span class="pl-cn">00</span>);

                <span class="pl-c">// Act</span>
                <span class="pl-k">var</span> result = LifeInfo.IsNowLunchBreak();

                <span class="pl-c">// Assert</span>
                Assert.IsFalse(result);
            }
        }
    }
}</pre></div>

<h3>
<a id="step-5-run-tests" class="anchor" href="#step-5-run-tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 5: Run Tests</h3>

<p>In fact, to enable any profiler based mocking tool, you have to set the environment variables. Therefore, such libraries - Microsoft Fakes/Typemock Isolator/Telerik JustMock provide small runner to satisfy the requisition, also it is true at Prig. Use <code>prig.exe</code> and run the test as follows(continue in the Package Manager Console): </p>

<div class="highlight highlight-powershell"><pre>PM&gt; <span class="pl-k"><span class="pl-k">cd</span></span> &lt;Your Test Project<span class="pl-s1"><span class="pl-pds">'</span>s Output Directory(e.g. cd .\ConsoleApplicationTest\bin\Debug)&gt;<span class="pl-ii"></span></span>
PM&gt; prig run <span class="pl-ko">-</span><span class="pl-k">process</span> <span class="pl-s1"><span class="pl-pds">"</span>C:\Program Files (x86)\NUnit 2.6.3\bin\nunit-console.exe<span class="pl-pds">"</span></span> <span class="pl-ko">-</span>arguments <span class="pl-s1"><span class="pl-pds">"</span>ConsoleApplicationTest.dll /domain=None /framework=v4.0<span class="pl-pds">"</span></span>
<span class="pl-k"><span class="pl-k">NUnit-Console</span></span> version <span class="pl-cn">2.6</span>.<span class="pl-cn">3.13283</span>
Copyright (C) <span class="pl-cn">2002</span><span class="pl-k"><span class="pl-k">-</span></span><span class="pl-cn">2012</span> Charlie Poole.
Copyright (C) <span class="pl-cn">2002</span><span class="pl-k"><span class="pl-k">-</span></span><span class="pl-cn">2004</span> James W. Newkirk, Michael C. Two, Alexei A. Vorontsov.
Copyright (C) <span class="pl-cn">2000</span><span class="pl-k"><span class="pl-k">-</span></span><span class="pl-cn">2002</span> Philip Craig.
All Rights Reserved.

Runtime Environment <span class="pl-ko">-</span> 
   OS Version: Microsoft Windows NT <span class="pl-cn">6.2</span>.<span class="pl-cn">9200.0</span>
  CLR Version: <span class="pl-cn">2.0</span>.<span class="pl-cn">50727.8000</span> ( Net <span class="pl-cn">3.5</span> )

ProcessModel: Default    DomainUsage: None
Execution Runtime: v4.0
...
Tests run: <span class="pl-cn">3</span>, Errors: <span class="pl-cn">0</span>, Failures: <span class="pl-cn">0</span>, Inconclusive: <span class="pl-cn">0</span>, Time: <span class="pl-cn">0.0934818542535837</span> seconds
  Not run: <span class="pl-cn">0</span>, Invalid: <span class="pl-cn">0</span>, Ignored: <span class="pl-cn">0</span>, Skipped: <span class="pl-cn">0</span>

PM&gt; 
</pre></div>

<h3>
<a id="final-step-refactoring-and-get-trig-back" class="anchor" href="#final-step-refactoring-and-get-trig-back" aria-hidden="true"><span class="octicon octicon-link"></span></a>Final Step: Refactoring and Get Trig Back!</h3>

<p>If tests have been created, you can refactor illimitably! For example, you probably can find the result of refactoring as follows: </p>

<div class="highlight highlight-cs"><pre><span class="pl-k">using</span> System;

<span class="pl-k">namespace</span> ConsoleApplication
{
    <span class="pl-s">public</span> <span class="pl-s">static</span> <span class="pl-s">class</span> <span class="pl-entc">LifeInfo</span>
    {
        <span class="pl-s">public</span> <span class="pl-s">static</span> <span class="pl-s">bool</span> <span class="pl-enf">IsNowLunchBreak</span>()
        {
            <span class="pl-c">// 1. Add overload to isolate from external environment then call it from original method.</span>
            <span class="pl-k">return</span> IsNowLunchBreak(DateTime.Now);
        }

        <span class="pl-s">public</span> <span class="pl-s">static</span> <span class="pl-s">bool</span> <span class="pl-enf">IsNowLunchBreak</span>(<span class="pl-s">DateTime</span> <span class="pl-vpf">now</span>)
        {
            <span class="pl-c">// 2. Also, I think the expression '12 &lt;= now.Hour &amp;&amp; now.Hour &lt; 13' is too complex.</span>
            <span class="pl-c">//    Better this way, isn't it?</span>
            <span class="pl-k">return</span> now.Hour == <span class="pl-cn">12</span>;
        }
        <span class="pl-c">// 3. After refactoring, no longer need to use Prig, because you can test this overload.</span>
    }
}</pre></div>

<p>As just described, Prig helps the code that depends on an untestable library gets trig back. I guarantee you will enjoy your development again!!</p>

<p>For more information, see also <a href="https://github.com/urasandesu/Prig/wiki">Prig's wiki</a>.</p>

<h1>
<a id="installation-from-source-code" class="anchor" href="#installation-from-source-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>INSTALLATION FROM SOURCE CODE</h1>

<h2>
<a id="dependency" class="anchor" href="#dependency" aria-hidden="true"><span class="octicon octicon-link"></span></a>DEPENDENCY</h2>

<p>To build this project needs the following dependencies: </p>

<ul>
<li><a href="http://www.visualstudio.com/">Visual Studio 2013(more than Professional Edition because it uses ATL)</a></li>
<li>
<a href="http://www.boost.org/">Boost 1.55.0</a><br>
Extract to C:\boost_1_55_0, and will build with the following options(x86 and x64 libs are required):</li>
</ul>

<pre lang="dos"><code>CMD boost_1_55_0&gt;cd
C:\boost_1_55_0

CMD boost_1_55_0&gt;bootstrap.bat
Building Boost.Build engine

Bootstrapping is done. To build, run:

    .\b2

To adjust configuration, edit 'project-config.jam'.
Further information:
...

CMD boost_1_55_0&gt;.\b2 link=static threading=multi variant=debug,release runtime-link=shared,static -j 4

Building the Boost C++ Libraries.

Performing configuration checks
...

CMD boost_1_55_0&gt;.\b2 link=static threading=multi variant=debug,release runtime-link=shared,static -j 4 --stagedir=.\stage\x64 address-model=64

Building the Boost C++ Libraries.

Performing configuration checks
...
</code></pre>

<ul>
<li>
<a href="https://code.google.com/p/googletest/">Google Test 1.6</a><br>
Extract to C:\gtest-1.6.0, and upgrade C:\gtest-1.6.0\msvc\gtest.sln to Visual Studio 2013. Choose the <code>Build</code> menu, and open <code>Configuration Manager...</code>. On <code>Configuration Manager</code> dialog box, in the <code>Active Solution Platform</code> drop-down list, select the <code>&lt;New...&gt;</code> option. After the <code>New Solution Platform</code> dialog box is opened, in the <code>Type or select the new platform</code> drop-down list, select a 64-bit platform. Then build all(Debug/Release) configurations.</li>
<li>
<a href="http://www.nunit.org/">NUnit 2.6.3.13283</a><br>
Install using with the installer(NUnit-2.6.3.msi).</li>
<li>
<a href="http://www.microsoft.com/en-us/download/details.aspx?id=40754">Modeling SDK for Microsoft Visual Studio 2013</a><br>
Install using with the installer(VS_VmSdk.exe).</li>
<li>
<a href="http://docs.nuget.org/docs/start-here/installing-nuget">NuGet Command-Line Utility</a><br>
Download command line utility <code>nuget.exe</code>, then append its path to the environment variable <code>path</code>.</li>
</ul>

<h2>
<a id="build" class="anchor" href="#build" aria-hidden="true"><span class="octicon octicon-link"></span></a>BUILD</h2>

<p>After preparing all dependencies, you can build this project in the following steps:</p>

<ol>
<li>Run Visual Studio as Administrator, and open Prig.sln(This sln contains some ATL projects, so the build process will modify registry).</li>
<li>According to the version of the product to use, change the solution configuration and the solution platform and build.</li>
<li>The results are output to <code>$(SolutionDir)$(Configuration)\$(PlatformTarget)\</code>.</li>
</ol>

<h2>
<a id="registration" class="anchor" href="#registration" aria-hidden="true"><span class="octicon octicon-link"></span></a>REGISTRATION</h2>

<p>Run Developer Command Prompt for VS2013 as Administrator, and register dlls that were output to <code>$(SolutionDir)$(Configuration)\$(PlatformTarget)\</code> to registry and GAC as follows(these are the examples for x86/.NET 3.5, but also another environments are in the same manner): </p>

<pre lang="dos"><code>CMD x86&gt;cd
C:\Prig\Release\x86

CMD x86&gt;regsvr32 /i Urasandesu.Prig.dll

CMD x86&gt;cd "..\..\Release(.NET 3.5)\AnyCPU"

CMD AnyCPU&gt;cd
C:\Prig\Release(.NET 3.5)\AnyCPU

CMD AnyCPU&gt;gacutil /i Urasandesu.NAnonym.dll
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.

Assembly successfully added to the cache

CMD AnyCPU&gt;gacutil /i Urasandesu.Prig.Framework.dll
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.

Assembly successfully added to the cache

CMD AnyCPU&gt;
</code></pre>

<h2>
<a id="unregistration" class="anchor" href="#unregistration" aria-hidden="true"><span class="octicon octicon-link"></span></a>UNREGISTRATION</h2>

<p>Unregistration operation is similar in the registration. Run Developer Command Prompt for VS2013 as Administrator and execute the following commands: </p>

<pre lang="dos"><code>CMD x86&gt;cd
C:\Prig\Release\x86

CMD x86&gt;regsvr32 /u Urasandesu.Prig.dll

CMD x86&gt;cd "..\..\Release(.NET 3.5)\AnyCPU"

CMD AnyCPU&gt;cd
C:\Prig\Release(.NET 3.5)\AnyCPU

CMD AnyCPU&gt;gacutil /u "Urasandesu.Prig.Framework, Version=0.1.0.0, Culture=neutral, PublicKeyToken=acabb3ef0ebf69ce, processorArchitecture=MSIL"
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.


Assembly: Urasandesu.Prig.Framework, Version=0.1.0.0, Culture=neutral, PublicKeyToken=acabb3ef0ebf69ce, processorArchitecture=MSIL
Uninstalled: Urasandesu.Prig.Framework, Version=0.1.0.0, Culture=neutral, PublicKeyToken=acabb3ef0ebf69ce, processorArchitecture=MSIL
Number of items uninstalled = 1
Number of failures = 0

CMD AnyCPU&gt;gacutil /u "Urasandesu.NAnonym, Version=0.2.0.0, Culture=neutral, PublicKeyToken=ce9e95b04334d5fb, processorArchitecture=MSIL"
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.33440
Copyright (c) Microsoft Corporation.  All rights reserved.


Assembly: Urasandesu.NAnonym, Version=0.2.0.0, Culture=neutral, PublicKeyToken=ce9e95b04334d5fb, processorArchitecture=MSIL
Uninstalled: Urasandesu.NAnonym, Version=0.2.0.0, Culture=neutral, PublicKeyToken=ce9e95b04334d5fb, processorArchitecture=MSIL
Number of items uninstalled = 1
Number of failures = 0

CMD AnyCPU&gt;
</code></pre>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
